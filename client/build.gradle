/*
 * Copyright OpenSearch Contributors
 * SPDX-License-Identifier: Apache-2.0
 */

apply plugin: 'opensearch.build'
apply plugin: 'io.freefair.lombok'
apply plugin: "com.diffplug.spotless"

allprojects {
    group = opensearch_group
    version = "${opensearch_build}"
}

repositories {
    mavenLocal()
    maven { url "https://aws.oss.sonatype.org/content/repositories/snapshots" }
    mavenCentral()
    maven { url "https://plugins.gradle.org/m2/" }
}

compileJava {
    options.compilerArgs.addAll(["-processor", 'lombok.launch.AnnotationProcessorHider$AnnotationProcessor'])
}
compileTestJava {
    options.compilerArgs.addAll(["-processor", 'lombok.launch.AnnotationProcessorHider$AnnotationProcessor'])
}


dependencies {
    compileOnly "${group}:opensearch:${opensearch_version}"

    testImplementation "junit:junit:${versions.junit}"
    testImplementation "org.mockito:mockito-core:${versions.mockito}"
    testImplementation "org.hamcrest:hamcrest:${versions.hamcrest}"
    testImplementation "net.bytebuddy:byte-buddy:${versions.bytebuddy}"
    testImplementation "net.bytebuddy:byte-buddy-agent:${versions.bytebuddy}"
    testImplementation "${group}:opensearch:${opensearch_version}"

}

licenseFile = "LICENSE.txt"
noticeFile = "NOTICE.txt"

spotless {
    java {
        removeUnusedImports()
        importOrder 'java', 'javax', 'org', 'com'
        eclipse().configFile rootProject.file('formatterConfig.xml')
        trimTrailingWhitespace()
        endWithNewline()
    }
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
    repositories {
        mavenLocal()
    }
}
